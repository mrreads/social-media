<?php
session_start();

require_once "DB.php";

$loginEmail = htmlspecialchars($_POST['loginEmail']);
$loginPassword = htmlspecialchars($_POST['loginPassword']);

if (isset($_POST['loginButton']))
{
    $userCheck = DB::queryCount("SELECT * FROM users WHERE user_email = '$loginEmail' AND user_password = '$loginPassword'");
    if ($userCheck == 1)
    {
        $dataUser = DB::query("SELECT id_user FROM users WHERE user_email = '$loginEmail' AND user_password = '$loginPassword'");
        $_SESSION['id_user'] = $dataUser['id_user'];
        header('Location: ./../profile.php');
    }
    else
    {
        setcookie("message", "Вы ввели неверные данные.", time() + 2, '/');
        header('Location: ./../login.php');
    }
}


$registerEmail = htmlspecialchars($_POST['registerEmail']);
$registerPassword = htmlspecialchars($_POST['registerPassword']);

if (isset($_POST['registerNext']))
{
    $userCheck = DB::queryCount("SELECT * FROM users WHERE user_email = '$registerEmail'");
    if ($userCheck == 0)
    {
        setcookie("check", true, time() + 2, '/');
        setcookie("email", $registerEmail, time() + 2, '/');
        setcookie("password", $registerPassword, time() + 2, '/');
        header('Location: ./../register.php');
    }
    else
    {
        setcookie("message", "Вы ввели существующие данные.", time() + 2, '/');
        header('Location: ./../register.php');
    }
}

$registerFirstName = htmlspecialchars($_POST['registerFirstName']);
$registerLastName = htmlspecialchars($_POST['registerLastName']);
$registerNickName = htmlspecialchars($_POST['registerNickName']);
$registerDate = htmlspecialchars($_POST['registerDate']);
$registerCountry = htmlspecialchars($_POST['registerCountry']);
$registerCity = htmlspecialchars($_POST['registerCity']);
$regusterInfo = htmlspecialchars($_POST['registerInfo']);

if (isset($_POST['registerButton']))
{
    $addAccount = DB::query("INSERT INTO `users` (`id_user`, `user_nickname`, `user_email`, `user_birthday`, `user_password`, `user_firstname`, `user_lastname`, `user_country`, `user_city`, `user_info`, `user_profileimage`) 
    VALUES (NULL, '$registerNickName', '$registerEmail', '$registerDate', '$registerPassword', '$registerFirstName', '$registerLastName', '$registerCountry', '$registerCity', '$regusterInfo', 0x89504e470d0a1a0a0000000d49484452000001f6000001f60803000000b5355e8e00000063504c5445000000dce6ecdce6ecdce6ecdce6ecdce6ecdce6ecdce6ecdce6ecdce6ecdce6ecdce6ecdce6ecdce6ecdce6ecdce6eca7bdcaccdae29cb5c3b2c5d1c7d6debccdd797b0bf8ca8b8d1dee5c1d1dbb7c9d4d7e2e9acc1cd92acbca2b9c687a4b5dce6ecb5f0dc4e0000001074524e530040bfef1060809f20df30cf8f70af50e412d8e20000132949444154785eecd74b6e83310804608c6d6cfcbc02f73f65954a59374dff879dceb7633d8211f40f00b82779e8cf29d36781f21d3133abfd80999348742ed0a620b8298dd9dea33ca4bb42db803265b01d43b9f5c51b00f29451ed048ff0693d5062633b970e59a7f52138616f17a9a917ba19e4d8aa5dcdb338ba098498d46e7347f4305bb5bbf9d1335d05721fb60a6d93ce07a5555b8b1f31d0896036b525f159e71e66f2b6b07a7cf25092b7e5d523af3de4a6b68911e9081062b59df854e88fc025db8ff6406f83d0d536951c5d038bbeffca43acb6bddfb53c64f1f61178d28ba024fb1cfad22f0f8ebfd83583dc0861188a161c08101854952eaad9fcfb9fb28bae46955a4447aa92ffde159e6c7f3b515bc4e8209e91fe9dfcd3dd16865992108f74c4231df148af5d3c74b34cc8e7523d2b5b93eb1c4c3779111bd2d32a3f66f793ed16b2a45f487296ac89a16e03237e0c99533afa7bfbd0e9d3577f87d82df33bf4934b94eb050fd1ceb1d4a12c96a50e23a55e3f143ca5ce841f42ed43a467576787ef4276f0f566d4efc0dc56b29b8a4e012d25bb3d7412b835d3e857d941a34f4506d0e849f024faed82002853dd0d3eeb0a101d7b5b5530e097901d0cf8417f014a72dcd62116c21c6f7236371a18ea0a73b39e026422fc3f80773e4f11e859dcf0ce159ea7d8ac6703b1601def58c77bd3a7391838cde11deb78c73adeb18e77ace31deb78af6a5f871deb97783d8ef7b7073e8ee3cedde602f993bd33da6e130682680d2686244d84b01020cbb3ffff957de94b7bd234b113d8117b7f61ce4a33da9524fa49e765f01eff227b37cc7d41ba9beae93c5c333e8477a1e7d7dd3aad69be8cf81cf1baa896be6e6daae25da6c5e336b29b29e72e4cf56919710fd1cd64badbb4640a23ee27ba5e54f262aabf41ef22be8831249ba7fd9b6327fa983dbe927899d4bf526bed9790f1e53885c23716d86f109d5ff847bbd3fa9b39e3db7093ca631b8b6e678fef240e49c462dca3a822397c37791655545bd8b95a34b144ac809f4413cf3b37f193c73ac461df76fec459eaf7334e14b6aefcae5bf25893b8881eba556ddd41f43047accc35b1db3a7e3b77c1fae47e97b6ae122da4119bb0100f55f29fcef5111be176376cf32a5a08119b312651c2d32aaab7b52861c096e47e57dbfb9328c1615b624fb7bdf3ffec95aed89cb09bedfda0d0c29beed58a5354a63a10f63163f562aaff49d8c3ac4da35475d3bd3bae98dd4c7520149fe22abdaa9bee87c2bbad6faa6ebad7c7a297780775f425df90aa74ab6ee775afe52ef1011ac98960992776f167e8642cf54264a5a4bfae1457a69b6f2cbabdcf52e2a1cdb166b07366e71f0a3c8b5ff03fccd63d16d76eeda19b6b712dd88e6563b7edfd67611335176827f64585f7b6e649ec96de4f25f9b99441c05050783fd812ff51e2548eabebccc57f182f0a688a69c178903017e2ea8e355bdfcd7a710f65dc734c119fc15c5d7b777823bcec66aeee5442789b22887004218e22bc3950514088ab34143bd6c0ca9dbfd8addc9fd8efb24f60c3919fd934d679a32df78ebccd1e41c785badc1b9ba4ba8d9898cbbd130564101288cbbdb1fb10b7320a6fb977dce9cda6a71bda624fb819cb701d6db107701285b4dc1bf6270c6cdc423ad2ab8e1358719ce57e10fed06eab7c4559ece241cbcc78f3b995127cbcadf22f8c1f3f05f09245e8a6ea8e853c1d6ecf579d085f0fcf2066e17badae168b6ff772a57b7bba9142b6768b70d2d1fd0be2404d2f2a68d8bee81e414d20fb59e22496da0bfa2aaea54a6f7206375e74f0ccf55bf302724407f50d8d767a47679e4e1aaa4fba3dc89985c8d49d440960671025b4447fb327b0e384c7d435bfd83b17ddc655200ce7be4d9d76632ec636c6e77fffa73cbb6a57f24aab3a6d810ce4ff1e2091f5091806664065813c43799c0b7a927f285e7b28e769ff27f099ee68400a3f321eb952bb87140e856cda81b97ced062863ebfe0c31286acf76a7ee42ed11192086a7a4733c8f5d976888e1a590391e3105507b9339314bedf267f973addaa9fd25df1c4fed7268b2c6f1d42e7f963fd7ab9dda8fd9e6786a17c46bce7c3cb58bcfcb37356ba7f69f19cf5ca95dfae9ebb16aedd4becffe3e08b5cb7de47b0f51386a8fcc29cbfd781ebc8e104593254547ed06b23864dabe51bbf42ddc01c298cad7de02d2b7703f111d5e9816c659fed20e4bedd179cab1b4b3184a1a47f14b3b7a6a8fce8f1c4b3b0b9dc52fee1788a363b626f9e2de401c8adbf6e43b77c843b3f2313a97d4097916b807c8a3495ddfcc507e864052f7b0e0d1ab8640b689cfda19d31908e425f1353ac6741e02794d9bac617ab68344ce69233ae6e92688e49034a2e3e23e4024dba4111d17770f919ca4477440cbe3b79487705b0825f01c26364dca888e2de57b0865590f239481dbb784b5310da4e238c7a7bb5805b15c39c7270be59f219696737c6c76c952b38ce52dc4d2a40ae4f92a98f390cba2f7a4583c5f894915caef20982b8bdf1265e5f7104ccbc46ca2501ea2513c7c8bcb2549469e99ba00d1ec8ad08ec0dd5b8a1ddc09b2b11cec7149a19dc3dd423887f8fb37aeee01d2d9c6d7ce607e2844fb1ed231dcb3c7dfb823224cd59942b43f413ebd63363e7265cc1605a079f4168f5d64edec6832a214ed2f2801c3782e1e51b335ec45ea7a6a8f8c0f9ce2636a7f4519b49ce263e66b762804fd88513cb5433d625696dabd631b836885312807c3828868d95914c4c8855d92769ec9b44807b5fb8ec54f51b41f50143eb0e1648ca4fc1665d13a9eb64ad04eef331e4f3beb253a4fed39b0b41e473bbdcbb74eedb0b47e47edf4de79507b11de691d4db1da31385aff324beddcbfcbcfd2503bda40ebb9b5f35cc682daef83bfdf39ac337838edbc77d1b5289873e9da61dc5d96758f05dcb7e7c7ab072c83a076405733c153bb37c68cfa17d60bdbc94d1e6bb4fa37833186da6fa41df4acdc52c0b5c70a7eca263dac9bb4e1afb9414da3f1d4fe81bd615a2cd49f126f3a29437df8e7d413e6b1a5f67fd04e1f98731a6b682761556fd5071f31db5e8cf66708c05cddb727d73e75eec6d9ef2f36ddd8cbd0bec1bde9f54d21d9ecb1825129a5ebf5ffbfed3bac88971f715fcc7cf3681b70c3c21a9bdbe3ca9b3f2468ffe0553176b1a0c718f0b0e13ed231b8083f5885f6f88edc885586d853bd9b7a4418ea02c42fb59f7127cc5706a6eab14a1b33b80ba3c72aa32b2ab17f4aded6607dab9360c0c38f21d2ec3e609dfeab9fa21fad9b859f52e7c4dbabfbaef36ef440f4a1be249887d26e428e02d3e1baf2373176d86d1723ed975ffb45406bc164a3a4d5ea2b3f7fb53ec2f19fd801ff94bb1de1727ce41a25462bf729e56dfa596b8996d38552fe05f7307cf25c4fad2a52576d7ca6006589f277d0feb3d44b11b3c72769cda827a5d4dfc35ba959eb614578d2946068335fa5fbc5b6d89e436ec4fdf0b3e47bb8eb8dc59f0bbed9ae7adc8931f239afcdad7d53743d83f6d2724df2bd5f16da4bad62091629c87fb26f33bf0cd5145ebbd419e4c46b577875d571f39b5df1156bca142b7d89cdfafcdf8f0afa86aa418c74f96fc83d2f9ef6cd6e5dfe1a9fffb65e9bf145e76325358a4ef748c8a02ae953bd7fd3beada785e03ca4bbe6594d5b94dd9bf6a79a1a8e84a9477486b9a61619af9b372a6b3bd1591fb76ec3d5d524e3f4aebda9aef9ff6c7d2ce7a1ba07098eefda7715f6905b9a97ef7c49f0c9b7ed6f9c2a7d85bbfb46b9a11faea1d20e588777edc77a9f6f73d7af941b1aadea7d506ebf79675bf76b4e6efec4a599d64eaaee57a6769b770e89a7780904a5edc7f27ba327f500cf515c367fd83fcc0b9d4a4d6fdd454c0f00e637a3d6b30aff49c2201d2f9b4dfa50defecfdebd26c7090341006e2c84786f1227eb4dfc20f73f657ea5546b03ab753255534d7f7710f4b42458c4579aaff0d7e8ecb7acf2681fe481e8ed22845c0c83bc7994bf2c9f23dfec827c6697e7c459aa6b900dde7ebc2d67db46def25cd579116f5b713db2c9ddf026afbf4d00d699ee9f2a10f9659de8002df6158cd5fc880c188eb1d8d5d99c9001e33116bb967b8b0c888758ec0af31daeb48758ec0af333ae8523ccec5aee13aecd0e0b3a399b94358685cddbe2909a79bcd37bdc7a93379bb2260bfcfbecda776f00d397fbd3e2902a9b0aef4dfcd39b66387cd0bb3c5e213f4da6f62cb0073a85ba091f2597814e9e2da6f62c92d7f1da760fc80c6af9af8b476aea12d60c2ebf6220178bd393d9c83db4eb295f634d45fd8cd7537ec0bac09ce355d04e58979873bcb27c8f7551399eb8b1e9b0a126f868c916353623b6ccbca7a9d4cbf780e153fe79118f9f2c0bd854d3eeb96af73561db6c50d1898b0f929eb02d928e6f1ae10276d4a45bed1ae112f6cc1ec73779327dc60391f27cbc5eee1d76d594bb6fea6747ec4b8ccdacfad91efb4e8453bb5eee1d6e097c53bb26f709b78c7c53bb26f716b7f47485bc6af919b70d0efff227afffe1eca4d9e8feb8f8a33df7800235d9dd377de0604489c455d6e8c6738b1215d53e8c0a9b0794e998129d325d44994894e894e9020ad58127d129d335289578129d325d8b522d4d47a79e2ea1dc03cb9727f5afa80ae52a7f07aae4d3d75ccb751c575db5f71a718f4811e47525aac37d02439057946f709f8620c82bcaff61e7be92268561288c5e909c48fde73079ffab9c479e01db4855f76ce1abee42c25814c7a8f87f90e7a37cc451d1da833cb55bd5ecb2fb8d3cb7f209c7256ee4bd6fe5338ecbceafb1e0e9d90474f8b91b0bc0092ee38cecfa680d0fd8249c933ccf6f9ce032cec9b63e7fa32e3f7620f99ddf983de3ac2c5ebf7ae43bb884f3a2d3b19d83bb649ca7e2736ce7e01e71457439b6737017c5155aec64a75f9d7eec4070786b0d07f782ab667fdb1a660fb86a70979ddfc18db86ef4b6ade1be66c075d95976664fa8215ac94e5fcd37353b154f97cd724d17514770b49b65f6825a463fd9997d402d938decf47ee0eac10a16275f4271292f19f568f1b19267f6889a1e2eb233fb8cba360fd9997d405d2af6b3f3c8f482da56f3ef5df90aae28aa1badbf8063f601f565b19d9dd917b4b09aceceec45d1c468393bb30f6823cbbdd9e9a3e35ffc6ebd393bf5fc8bdf6d56af9267f601eda8d83c5cc3ec112d3d4c6667f6196d2d06b333bb4c684b677bd9993da0b549ac6567f60ded0563d999bd283a48b6b233fb841e74b6949dd957f431899decccbea19760263bb3cf8a6e9291eccc2e133a9a6d6467f6809e542c6467f6057d4d06b233fb88dec2ed2f5e99bd28ba4b371fb3e0e99affecdd6d92a3201485e1235c45c1ce879d68d22499bbff554ecd9fb16aaabbba334944e53c5b780b4154b41e0998b4d9f92edd16294848999dd9df9086b7e93e86627687547cb2eccc6e904e99e88069660f8284aa24879830bbad91944b909dd9ad47629be9b3337b81d4244c9d9dd94ba42761daeccc5e620ec44e999dd95bcc83b7d39d39cbec0e73e1ed544f5e99dd613ebc9d223bddd4614ebc3dbf3c00f5d1605e8a097eedcbea413033655edd597dec3ee4d380d5c7eefb9775a76ea6d581d2beaa3bed340866cabfac3bab1b0172ebceea0ec0acbbf7cf0e40177598376fe393bbd3511de6ce87677767f516f32741774f0b40c3414b20afee34ecb5c442b8276dd4527fb20516c3e979783c0075d17a249078a3965b73351665fbf08d1c7da8112c8cb7f191851d0d6775581e090fbc6845d7bdbe6189e4a1851d17735b2c54a5ffb7434f176d3c166b6be3edee00341cd50816ccdf3fc153bfd716cb261b3ddc35c1d32eda128b5769ec7e1e803e3478ac4071d72733bc6f73825510f3c30b3ddde278b79ecf859e2bf8c663450aab1fdf04a0fea41bc1aa88f966eb86ded596589d37d5cb9701e87ad05063857cd0c3f5f30074895a61a55a8d5f0c780ef5a6c06a15cde7039e43bd15ac98e436e039d4c7019fcb929e437d24ed78ac15f57b6d0a64a1087afab36947c3bb6a2bc845a57a1c58fd76d2e09191da68bc7029672b64a6b4baef32bfbe6f6a64475ad573b637f1bb933605b2e48dea7b96537c375edf73b46d34c36f67ae475557236352593d75d94deaa640e6c4a91eba8ca2476d4a106aa3d93ca0d9c5bf933a1546f578cd62f96e2b018d0f68c6f02b8efeefcbd0548ee1d71bbdc6a718be5f67f4dfed98dbb29c201444038e38a8780174108de9ffffca507aa62a0fa792b93a6876d7fa8355bbe9e21fd249bcd5475cef24fdafa405609b637dcef8dba4d3aa77d361be6cfb0eb4de6f8265c0e80fb1ee1a0b4845d26fe35c26c030efbddd8d038a9474dece49c99d77bdee00648c54de495d01e8f43eb7fbe400291ede71d4f5ceecee959f07009cdafd71520ec0363b2afbde3b2029e9d09fe32c24806edec78a9b5a00554dda5e00cb12608cdefc65715e283af497915688dbfccf690020cb9c5cbd9453c4e6d76e4fdee89ccc6368a2daf6dabbe5cedffea093f9d6eb38cebc1946eaf66da833899061ea3fbbe066df2284d386db8a5c71848c41fd4795cbac3e918d4da9cb62556ff4c6c5be2a4f2a45d5fe114e5fead1faa6dfe2c8b5195c1cca49bde058627da3df77e357e39019298f845c650596b48399f58b4f7cf2764408122e6ada6f91c154c6b1c6596fb47efac01b3358ac91643c66f25a541cd7d8a07fd2fa728fed5e6b13743b7c25e1a562b4d7f7c09929c139fe486bad352193fe2eb309e9ac5dcafc8ae499a81909d81f2ce82f394f70470ace45d04d8d7e0472c6980829f977a94448cad8ff52e6bf0137b018433e29fb7d0000000049454e44ae426082);");
header('Location: ./../index.php');
}